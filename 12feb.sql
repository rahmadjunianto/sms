SELECT id_dukb,nama_supplier,tanggal,kd_siklus,jenis_kayu,plat_nomor,kode_lokasi AS kd_asal,a.kabupaten,a.kecamatan,nm_grader,
SUM(CASE WHEN e.panjang_kayu = '100' AND e.kd_bawah='10' AND e.kd_atas='15' THEN e.batang ELSE 0 END) AS b1001015, SUM(CASE WHEN e.panjang_kayu = '100' AND e.kd_bawah='10' AND e.kd_atas='15' THEN e.volume ELSE 0 END) AS v1001015, SUM(CASE WHEN e.panjang_kayu = '100' AND e.kd_bawah='10' AND e.kd_atas='15' THEN e.harga ELSE 0 END) AS h1001015, SUM(CASE WHEN e.panjang_kayu = '100' AND e.kd_bawah='16' AND e.kd_atas='15' THEN e.batang ELSE 0 END) AS b1001615, SUM(CASE WHEN e.panjang_kayu = '100' AND e.kd_bawah='16' AND e.kd_atas='15' THEN e.volume ELSE 0 END) AS v1001615, SUM(CASE WHEN e.panjang_kayu = '100' AND e.kd_bawah='16' AND e.kd_atas='15' THEN e.harga ELSE 0 END) AS h1001615, SUM(CASE WHEN e.panjang_kayu = '100' AND e.kd_bawah='16' AND e.kd_atas='20' THEN e.batang ELSE 0 END) AS b1001620, SUM(CASE WHEN e.panjang_kayu = '100' AND e.kd_bawah='16' AND e.kd_atas='20' THEN e.volume ELSE 0 END) AS v1001620, SUM(CASE WHEN e.panjang_kayu = '100' AND e.kd_bawah='16' AND e.kd_atas='20' THEN e.harga ELSE 0 END) AS h1001620, SUM(CASE WHEN e.panjang_kayu = '130' AND e.kd_bawah='15' AND e.kd_atas='19' THEN e.batang ELSE 0 END) AS b1301519, SUM(CASE WHEN e.panjang_kayu = '130' AND e.kd_bawah='15' AND e.kd_atas='19' THEN e.volume ELSE 0 END) AS v1301519, SUM(CASE WHEN e.panjang_kayu = '130' AND e.kd_bawah='15' AND e.kd_atas='19' THEN e.harga ELSE 0 END) AS h1301519, SUM(CASE WHEN e.panjang_kayu = '130' AND e.kd_bawah='20' AND e.kd_atas='24' THEN e.batang ELSE 0 END) AS b1302024, SUM(CASE WHEN e.panjang_kayu = '130' AND e.kd_bawah='20' AND e.kd_atas='24' THEN e.volume ELSE 0 END) AS v1302024, SUM(CASE WHEN e.panjang_kayu = '130' AND e.kd_bawah='20' AND e.kd_atas='24' THEN e.harga ELSE 0 END) AS h1302024, SUM(CASE WHEN e.panjang_kayu = '130' AND e.kd_bawah='25' AND e.kd_atas='29' THEN e.batang ELSE 0 END) AS b1302529, SUM(CASE WHEN e.panjang_kayu = '130' AND e.kd_bawah='25' AND e.kd_atas='29' THEN e.volume ELSE 0 END) AS v1302529, SUM(CASE WHEN e.panjang_kayu = '130' AND e.kd_bawah='25' AND e.kd_atas='29' THEN e.harga ELSE 0 END) AS h1302529, SUM(CASE WHEN e.panjang_kayu = '260' AND e.kd_bawah='23' AND e.kd_atas='24' THEN e.batang ELSE 0 END) AS b2602324, SUM(CASE WHEN e.panjang_kayu = '260' AND e.kd_bawah='23' AND e.kd_atas='24' THEN e.volume ELSE 0 END) AS v2602324, SUM(CASE WHEN e.panjang_kayu = '260' AND e.kd_bawah='23' AND e.kd_atas='24' THEN e.harga ELSE 0 END) AS h2602324, SUM(CASE WHEN e.panjang_kayu = '260' AND e.kd_bawah='25' AND e.kd_atas='29' THEN e.batang ELSE 0 END) AS b2602529, SUM(CASE WHEN e.panjang_kayu = '260' AND e.kd_bawah='25' AND e.kd_atas='29' THEN e.volume ELSE 0 END) AS v2602529, SUM(CASE WHEN e.panjang_kayu = '260' AND e.kd_bawah='25' AND e.kd_atas='29' THEN e.harga ELSE 0 END) AS h2602529,
SUM(CASE WHEN e.panjang_kayu = '100'  THEN e.batang  ELSE 0 END) AS b100,
SUM(CASE WHEN e.panjang_kayu = '100'  THEN e.volume  ELSE 0 END) AS v100,
SUM(CASE WHEN e.panjang_kayu = '100'  THEN e.harga  ELSE 0 END) AS h100
FROM tr_dukb a
JOIN ref_supplier b ON a.kode_supplier = b.kode_supplier
JOIN ref_lokasi_kayu c ON a.kecamatan=c.kecamatan AND a.kabupaten=c.kabupaten
JOIN ref_grader d ON a.kd_grader=d.kd_grader 
JOIN tr_dukb_detail e ON a.id_dukb=e.tr_dukb_id
WHERE YEAR(tanggal)='2018' AND MONTH(tanggal)='02' AND STATUS='Tervalidasi' AND a.kd_pengguna=7
GROUP BY a.id_dukb